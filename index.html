<html>
<head>
  <title>Backmoji - The Bitmoji Enumerator</title>
  <style>
    * {
        margin: 0;
        padding:0;
    }
    .avatar {
        width: 300px;
        display: inline-block;
    }
    img {
      height: 200px;
      width: auto;
    }
  </style>
</head>

<body>
<h1>Backmoji - The Bitmoji Enumerator</h1>
<p>Backmoji takes a Bitmoji ID, version (usually the number 5), and a maximum value.</p>
<p>Press the "Grab Images!" button and your browser will make "maximum value" requests for the </p>
<p>images of that user's Bitmoji. Those images will be displayed below.</p>
<br><br>
    <p>Sample Bimoji ID value: 99792039934</p>
    <p>Version: 5</p>
    <br>
    <br>

    <ul>
        <li>Replace the default value with your Bitmoji ID: <input type="number" placeholder="99792039934" id="bid"></li>
        <li>Replace the default value with your version value: <input type="number" id="bversion" placeholder="5"></li>
        <li>Upper value: <input type="number" id="upperVal" placeholder="20"></li>
    </ul>
    <button type="button" onclick="getInputValue();">Grab Images!</button>

    <div id="all"></div>

    <script type="text/javascript" style="display: none;">
        function getInputValue(){
            // Selecting the input element and get its value
            var userID = document.getElementById("bid").value;
            var version = document.getElementById("bversion").value;
            var upperValue = document.getElementById("upperVal").value;

           var all = document.querySelector("#all");
            const queryString = window.location.search;

            function nextImg(i) {
                var container = document.createElement('div');
                container.classList.add("avatar");
                var img = document.createElement('img');
                var id  = userID+"_"+i+"-s"+version;
                img.src= "https://images.bitmoji.com/3d/avatar/201714142-" + id + "-v1.webp";
                container.appendChild(img);
                const textNode = document.createElement("br");
                container.appendChild(textNode);

                //var p = document.createElement('p');
                //p.innerText = "<a href src=" + img.src + " target='_blank'>" + id +"</a>";
                //container.appendChild(p);

                const x = document.createElement("A");
                const t = document.createTextNode(id);
                x.setAttribute("href", img.src);
                x.setAttribute('target', '_blank');
                x.appendChild(t);
                container.appendChild(x);

                all.appendChild(container);
                console.log(i)
                if (i==upperValue) {
                    return;
                } else {
                    setTimeout(() => nextImg(i+1), 500);
                }
            }

            nextImg(0);
        }
    </script>

    </body>
</html>
